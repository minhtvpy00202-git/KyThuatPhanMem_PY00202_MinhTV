package mini.expense.config;
import com.zaxxer.hikari.HikariConfig;
import com.zaxxer.hikari.HikariDataSource;
import javax.sql.DataSource;
import java.io.InputStream;
import java.util.Properties;

public class DataSourceProvider {
  private static final HikariDataSource ds;
  static {
    try {
      Properties p = new Properties();
      try (InputStream in = DataSourceProvider.class.getClassLoader().getResourceAsStream("db.properties")) {
        p.load(in);
      }
      HikariConfig cfg = new HikariConfig();
      cfg.setJdbcUrl(p.getProperty("db.url"));
      cfg.setUsername(p.getProperty("db.user"));
      cfg.setPassword(p.getProperty("db.pass"));
      cfg.setMaximumPoolSize(Integer.parseInt(p.getProperty("db.pool","8")));
      ds = new HikariDataSource(cfg);
    } catch (Exception e) { throw new RuntimeException(e); }
  }
  public static DataSource get(){ return ds; }
}
